{"version":3,"file":"index.modern.js","sources":["../src/player/player.tsx","../src/player/index.tsx","../src/index.tsx"],"sourcesContent":["import React from \"react\";\r\nimport videojs from \"video.js\";\r\nimport \"./player.css\";\r\n\r\ninterface IVideoJSProps {\r\n  options: any;\r\n}\r\nexport const VideoJS: React.FC<IVideoJSProps> = (props) => {\r\n  const videoRef: any = React.useRef(null);\r\n  const playerRef: any = React.useRef(null);\r\n  const { options } = props;\r\n\r\n  React.useEffect(() => {\r\n    // make sure Video.js player is only initialized once\r\n    if (!playerRef.current) {\r\n      const videoElement = videoRef.current;\r\n      if (!videoElement) return;\r\n      const player = (playerRef.current = videojs(videoElement, options, () => {\r\n        console.log(\"player is ready\");\r\n        handlePlayerReady(player);\r\n      }));\r\n    } else {\r\n      // you can update player here [update player through props]\r\n      // const player = playerRef.current;\r\n      // player.autoplay(options.autoplay);\r\n      // player.src(options.sources);\r\n    }\r\n  }, [options, videoRef]);\r\n\r\n  // Dispose the Video.js player when the functional component unmounts\r\n  React.useEffect(() => {\r\n    const player = playerRef.current;\r\n\r\n    return () => {\r\n      if (player) {\r\n        player.dispose();\r\n        playerRef.current = null;\r\n      }\r\n    };\r\n  }, [playerRef]);\r\n\r\n  const handlePlayerReady = (player: any) => {\r\n    player.on(\"waiting\", () => {\r\n      console.log(\"player is waiting\");\r\n    });\r\n\r\n    player.on(\"dispose\", () => {\r\n      console.log(\"player will dispose\");\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div data-vjs-player>\r\n      <video ref={videoRef} className=\"video-js vjs-big-play-centered\" />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default VideoJS;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport VideoJS from \"./player\";\r\nimport axios from \"axios\";\r\nimport { VideoJsPlayerOptions } from \"video.js\";\r\n\r\ninterface IVideoJSPlayerProps {\r\n  apiEndPoint?: string;\r\n  vid: string;\r\n  token: string;\r\n  autoPlay?: boolean;\r\n}\r\n\r\nconst ELearningPlayer: React.FC<IVideoJSPlayerProps> = ({\r\n  vid,\r\n  apiEndPoint = \"https://elearning.dev.ovptek.vn\",\r\n  token,\r\n  autoPlay = false,\r\n}) => {\r\n  const [options, setOptions] = useState<VideoJsPlayerOptions>();\r\n\r\n  useEffect(() => {\r\n    axios\r\n      .get(`${apiEndPoint}/api/v1/media/${vid}`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n      })\r\n      .then((res) => {\r\n        if (res && res.data) {\r\n          const { hls } = res.data.url;\r\n          let videoJsOptions: VideoJsPlayerOptions = {\r\n            autoplay: autoPlay,\r\n            controls: true,\r\n            responsive: true,\r\n            fluid: true,\r\n            // playsinline: true,\r\n            defaultVolume: 0,\r\n            html5: {\r\n              nativeControlsForTouch: false,\r\n              nativeAudioTracks: false,\r\n              nativeVideoTracks: false,\r\n              vhs: {\r\n                enableLowInitialPlaylist: true,\r\n                overrideNative: true,\r\n                fastQualityChange: true,\r\n                cacheEncryptionKeys: true,\r\n              },\r\n            },\r\n            sources: [\r\n              {\r\n                src: `${apiEndPoint}/${hls}`,\r\n                type: \"application/x-mpegURL\",\r\n              },\r\n            ],\r\n          };\r\n          setOptions(videoJsOptions);\r\n        }\r\n      });\r\n  }, [vid, autoPlay, apiEndPoint, token]);\r\n\r\n  return options ? <VideoJS options={options} /> : <div></div>;\r\n};\r\n\r\nexport default ELearningPlayer;\r\n","import React from \"react\";\r\nimport ELearningPlayer from \"./player\";\r\n\r\ninterface IPlayerELearning {\r\n  vid: string;\r\n  token: string;\r\n  apiEndPoint?: string;\r\n  autoPlay?: boolean;\r\n}\r\nexport const PlayerELearning = (props: IPlayerELearning) => {\r\n  return <ELearningPlayer {...props} />;\r\n};\r\n"],"names":["VideoJS","props","videoRef","React","useRef","playerRef","options","useEffect","current","videoElement","player","videojs","console","log","handlePlayerReady","dispose","on","ref","className","ELearningPlayer","vid","apiEndPoint","token","autoPlay","useState","setOptions","axios","get","headers","Authorization","then","res","data","hls","url","videoJsOptions","autoplay","controls","responsive","fluid","defaultVolume","html5","nativeControlsForTouch","nativeAudioTracks","nativeVideoTracks","vhs","enableLowInitialPlaylist","overrideNative","fastQualityChange","cacheEncryptionKeys","sources","src","type","PlayerELearning"],"mappings":"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"}